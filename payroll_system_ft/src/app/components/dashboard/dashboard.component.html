<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Dashboard de Nómina</h1>
    <div class="filters">
      <div class="filter-group">
        <label for="filterMonth">Mes:</label>
        <select id="filterMonth" [(ngModel)]="selectedMonth" (change)="onFilterChange()">
          <option value="">Todo el año</option>
          <option *ngFor="let month of months" [value]="month">{{ month }}</option>
        </select>
      </div>
      <div class="filter-group">
        <label for="filterYear">Año:</label>
        <select id="filterYear" [(ngModel)]="selectedYear" (change)="onFilterChange()">
          <option *ngFor="let year of years" [value]="year">{{ year }}</option>
          <option [value]="nextYear" disabled>{{ nextYear }} (Próximo)</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">Gasto Total Nómina</div>
      <div class="stat-value">${{ totalPayroll | number:'1.2-2' }}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Total Entregas</div>
      <div class="stat-value">{{ totalDeliveries }}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Total Bonos</div>
      <div class="stat-value">${{ totalBonuses | number:'1.2-2' }}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Total Retenciones (ISR)</div>
      <div class="stat-value">${{ totalDeductions | number:'1.2-2' }}</div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="charts-row">
    <!-- Monthly Trend Chart -->
    <div class="chart-card">
      <div class="chart-header">
        <h3>Tendencia Mensual</h3>
      </div>
      <div class="chart-container">
        <canvas id="trendChart"></canvas>
      </div>
    </div>

    <!-- Expense Distribution Chart -->
    <div class="chart-card small">
      <div class="chart-header">
        <h3>Distribución de Gastos</h3>
      </div>
      <div class="chart-container">
        <canvas id="expenseChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Employee Details Table -->
  <div class="details-card">
    <div class="details-header">
      <h3>{{ selectedMonth ? 'Detalle del Mes: ' + selectedMonth : 'Detalle del Año ' + selectedYear }}</h3>
    </div>
    <div class="table-container">
      <table class="details-table">
        <thead>
          <tr>
            <th>Empleado</th>
            <th>Horas Trabajadas</th>
            <th>Pago Entregas</th>
            <th>Retenciones (ISR)</th>
            <th>Vales Despensa</th>
            <th>Valor Total (Neto)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let employee of employeeDetails">
            <td>
              <div class="employee-name">{{ employee.name }}</div>
              <div class="employee-number">{{ employee.employeeNumber }}</div>
            </td>
            <td class="hours-worked">{{ employee.hoursWorked }} hrs</td>
            <td class="amount positive">${{ employee.deliveryPayment | number:'1.2-2' }}</td>
            <td class="amount negative">-${{ employee.deductions | number:'1.2-2' }}</td>
            <td class="amount positive">${{ employee.foodVouchers | number:'1.2-2' }}</td>
            <td class="amount total">${{ employee.totalNet | number:'1.2-2' }}</td>
          </tr>
          <tr *ngIf="employeeDetails.length === 0">
            <td colspan="6" class="no-data">No hay datos disponibles para este período</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-overlay" *ngIf="loading">
    <div class="loading-content">
      <div class="spinner"></div>
      <div class="loading-text">Cargando datos<span class="dots"><span>.</span><span>.</span><span>.</span></span></div>
    </div>
  </div>
</div>
